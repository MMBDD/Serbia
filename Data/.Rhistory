setwd("C:/Users/berto011/OneDrive - Wageningen University & Research/Proyectos/ANTARES-TOMATES/Serbia/Serbia/Data")
library(prospectr)
library(caret)
library(rchemo)
file1= "BRIOSOa.csv"
file2="BRIOSOb.csv"
file3 = "CAPPRICIAa.csv"
file4="CAPPRICIAb.csv"
file5 = "PROVINEa.csv"
file6="PROVINEb.csv"
XBI=read.csv(file1, row.names=1, check.names = FALSE)
XB=XBI[,4:115]
row_names_df_to_remove1<-c("2599", "4038", "983", "3222", "3955", "3651", "440", "5160")
YB=read.csv(file2, row.names=1)
YB=as.data.frame(YB[,11])
joinB=cbind(XB,YB)
joinB=(joinB[!(row.names(joinB) %in% row_names_df_to_remove1),])
XB=joinB[,1:112]
YB=as.data.frame(joinB[,113])
XC=read.csv(file3, row.names=1, check.names = FALSE)
row_names_df_to_remove<-c("i2T11S5", "i2T5S3", "i1T1S3", "i1T1S2")
row_names_df_to_remover<-c("i1T1S3", "i1T1S2")
YC=read.csv(file4, row.names=1)
YC=as.data.frame(YC[,11])
joinC=cbind(XC,YC)
joinC=as.data.frame(joinC[!(row.names(joinC) %in% row_names_df_to_remove),])
joinC=as.data.frame(joinC[!(row.names(joinC) %in% row_names_df_to_remover),])
XC=joinC[,1:112]
YC=as.data.frame(joinC[,113])
XP=read.csv(file5, row.names=1, check.names = FALSE)
XP=XP[,4:115]
YP=read.csv(file6, row.names=1)
YP=as.data.frame(YP[,11])
joinP=cbind(XP,YP)
row_names_df_to_remove2<-c("7790", "9639", "0", "7232","10340", "1002", "4117")
joinP=joinP[!(row.names(joinP) %in% row_names_df_to_remove2),]
XP=joinP[,1:112]
YP=as.data.frame(joinP[,113])
setwd("C:/Users/berto011/OneDrive - Wageningen University & Research/Proyectos/ANTARES-TOMATES/Serbia/Serbia/Data")
library(prospectr)
library(caret)
library(rchemo)
file1= "BRIOSOa.csv"
file2="BRIOSOb.csv"
file3 = "CAPPRICIAa.csv"
file4="CAPPRICIAb.csv"
file5 = "PROVINEa.csv"
file6="PROVINEb.csv"
# Import Table
XB=read.csv(file1, row.names=1, check.names=FALSE)
# Select only Spectra Columns
XB=XB[,4:115]
# Go down to line 117 and perform Exploration by PCA
# Detect outliers and add them to row_names_df_to_remove1
row_names_df_to_remove1<-c("2599", "4038", "983", "3222", "3955", "3651", "440", "5160")
#Import Labels
YB=read.csv(file2, row.names=1)
#Select column related to Label Scenario 2
YB=as.data.frame(YB[,12])
# Before removing outliers, join X and Y in order to remove the same samples from both datasets
joinB=cbind(XB,YB)
# Before removing outliers, join X and Y in order to remove the same samples from both datasets
joinB=cbind(XB,YB)
#Remove outliers at sepal level
joinB=(joinB[!(row.names(joinB) %in% row_names_df_to_remove1),])
#Create cleaned X and Y matrices
XB=joinB[,1:112]
YB=as.data.frame(joinB[,113])
#Repeat the same procedure with the variety Cappricia
XC=read.csv(file3, row.names=1, check.names=FALSE)
row_names_df_to_remove<-c("i2T11S5", "i2T5S3", "i1T1S3", "i1T1S2")
row_names_df_to_remover<-c("i1T1S3", "i1T1S2")
YC=read.csv(file4, row.names=1)
YC=as.data.frame(YC[,12])
joinC=cbind(XC,YC)
joinC=as.data.frame(joinC[!(row.names(joinC) %in% row_names_df_to_remove),])
joinC=as.data.frame(joinC[!(row.names(joinC) %in% row_names_df_to_remover),])
XC=joinC[,1:112]
YC=as.data.frame(joinC[,113])
#Repeat the same procedure with the variety Provine
XP=read.csv(file5, row.names=1, check.names=FALSE)
XP=XP[,4:115]
YP=read.csv(file6, row.names=1)
YP=as.data.frame(YP[,11])
joinP=cbind(XP,YP)
row_names_df_to_remove2<-c("7790", "9639", "0", "7232","10340", "1002", "4117")
joinP=joinP[!(row.names(joinP) %in% row_names_df_to_remove2),]
XP=joinP[,1:112]
YP=as.data.frame(joinP[,113])
snvC=as.data.frame(snv(XC))
snvP=as.data.frame(snv(XP))
snvB=as.data.frame(snv(XB))
#First or Second Derivative, to SNV or to raw data
SGC=as.data.frame(savgol(snvC,2,17,2))
SGP=as.data.frame(savgol(snvP,2,17,2))
SGB=as.data.frame(savgol(snvB,2,17,2))
pcaP=prcomp(SGC, retx = TRUE, center = TRUE, scale. = TRUE, tol = NULL, rank.=8)
pcaC=prcomp(SGP, retx = TRUE, center = TRUE, scale. = TRUE, tol = NULL, rank.=8)
pcaB=prcomp(SGB, retx = TRUE, center = TRUE, scale. = TRUE, tol = NULL, rank.=8)
pcaC=prcomp(SGC, retx = TRUE, center = TRUE, scale. = TRUE, tol = NULL, rank.=8)
pcaP=prcomp(SGP, retx = TRUE, center = TRUE, scale. = TRUE, tol = NULL, rank.=8)
pcaB=prcomp(SGB, retx = TRUE, center = TRUE, scale. = TRUE, tol = NULL, rank.=8)
# Change colour of bar plot
c.pc1 <- ifelse(pca$rotation[,1] > 0, yes="green2", no="red2")
c.pc2 <- ifelse(pca$rotation[,2] > 0, "green2", "red2")
c.pc3 <- ifelse(pca$rotation[,3] > 0, "green2", "red2")
n.pc1 <- ifelse(pca$rotation[,1] > 0, yes=-0.0, no=pca$rotation[,1]-0.01)
n.pc2 <- ifelse(pca$rotation[,2] > 0, yes=-0.0, no=pca$rotation[,2]-0.01)
n.pc3 <- ifelse(pca$rotation[,3] > 0, yes=-0.0, no=pca$rotation[,3]-0.01)
# Change colour of bar plot
c.pc1 <- ifelse(pcaC$rotation[,1] > 0, yes="green2", no="red2")
c.pc2 <- ifelse(pcaC$rotation[,2] > 0, "green2", "red2")
c.pc3 <- ifelse(pcaC$rotation[,3] > 0, "green2", "red2")
n.pc1 <- ifelse(pcaC$rotation[,1] > 0, yes=-0.0, no=pca$rotation[,1]-0.01)
n.pc2 <- ifelse(pcaC$rotation[,2] > 0, yes=-0.0, no=pca$rotation[,2]-0.01)
# Change colour of bar plot
c.pc1 <- ifelse(pcaC$rotation[,1] > 0, yes="green2", no="red2")
c.pc2 <- ifelse(pcaC$rotation[,2] > 0, "green2", "red2")
c.pc3 <- ifelse(pcaC$rotation[,3] > 0, "green2", "red2")
n.pc1 <- ifelse(pcaC$rotation[,1] > 0, yes=-0.0, no=pcaC$rotation[,1]-0.01)
n.pc2 <- ifelse(pcaC$rotation[,2] > 0, yes=-0.0, no=pcaC$rotation[,2]-0.01)
n.pc3 <- ifelse(pcaC$rotation[,3] > 0, yes=-0.0, no=pcaC$rotation[,3]-0.01)
cP.pc1 <- ifelse(pcaP$rotation[,1] > 0, yes="green2", no="red2")
cP.pc2 <- ifelse(pcaP$rotation[,2] > 0, "green2", "red2")
cP.pc3 <- ifelse(pcaP$rotation[,3] > 0, "green2", "red2")
nP.pc1 <- ifelse(pcaP$rotation[,1] > 0, yes=-0.0, no=pcaP$rotation[,1]-0.01)
nP.pc2 <- ifelse(pcaP$rotation[,2] > 0, yes=-0.0, no=pcaP$rotation[,2]-0.01)
nP.pc3 <- ifelse(pcaP$rotation[,3] > 0, yes=-0.0, no=pcaP$rotation[,3]-0.01)
cB.pc1 <- ifelse(pcaB$rotation[,1] > 0, yes="green2", no="red2")
cB.pc2 <- ifelse(pcaB$rotation[,2] > 0, "green2", "red2")
cB.pc3 <- ifelse(pcaB$rotation[,3] > 0, "green2", "red2")
nB.pc1 <- ifelse(pcaB$rotation[,1] > 0, yes=-0.0, no=pcaB$rotation[,1]-0.01)
nB.pc2 <- ifelse(pcaB$rotation[,2] > 0, yes=-0.0, no=pcaB$rotation[,2]-0.01)
nB.pc3 <- ifelse(pcaB$rotation[,3] > 0, yes=-0.0, no=pcaB$rotation[,3]-0.01)
par(mar=c(7,7,7,1)) # Set margins
par(mfrow = c(3, 1))
barplot(pcaC$rotation[,1], main="PC 1",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc1,cex.sub=2, cex.lab=2, cex.names=2)
barplot(pcaC$rotation[,2], main="PC 2",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc2,cex.sub=2, cex.lab=2, cex.names=2)
barplot(pcaC$rotation[,3], main="PC 3",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(9,7,9,1)) # Set margins
par(mfrow = c(3, 1))
barplot(pcaC$rotation[,1], main="PC 1",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc1,cex.sub=2, cex.lab=2, cex.names=2)
barplot(pcaC$rotation[,2], main="PC 2",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc2,cex.sub=2, cex.lab=2, cex.names=2)
barplot(pcaC$rotation[,3], main="PC 3",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(9,7,10,1)) # Set margins
par(mfrow = c(3, 1))
barplot(pcaC$rotation[,1], main="PC 1",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc1,cex.sub=2, cex.lab=2, cex.names=2)
barplot(pcaC$rotation[,2], main="PC 2",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc2,cex.sub=2, cex.lab=2, cex.names=2)
barplot(pcaC$rotation[,3], main="PC 3",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(10,7,10,1)) # Set margins
par(mfrow = c(3, 1))
barplot(pcaC$rotation[,1], main="PC 1",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc1,cex.sub=2, cex.lab=2, cex.names=2)
barplot(pcaC$rotation[,2], main="PC 2",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc2,cex.sub=2, cex.lab=2, cex.names=2)
barplot(pcaC$rotation[,3], main="PC 3",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(10,7,11,1)) # Set margins
par(mfrow = c(3, 1))
barplot(pcaC$rotation[,1], main="PC 1",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc1,cex.sub=2, cex.lab=2, cex.names=2)
barplot(pcaC$rotation[,2], main="PC 2",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc2,cex.sub=2, cex.lab=2, cex.names=2)
barplot(pcaC$rotation[,3], main="PC 3",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(11,7,11,1)) # Set margins
par(mfrow = c(3, 1))
barplot(pcaC$rotation[,1], main="PC 1",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc1,cex.sub=2, cex.lab=2, cex.names=2)
barplot(pcaC$rotation[,2], main="PC 2",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc2,cex.sub=2, cex.lab=2, cex.names=2)
barplot(pcaC$rotation[,3], main="PC 3",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(11,7,11,1)) # Set margins
par(mfrow = c(3, 1))
barplot(pcaC$rotation[,1], main="PC 1",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc1,cex.sub=2, cex.lab=2, xlab(NULL))
barplot(pcaC$rotation[,2], main="PC 2",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc2,cex.sub=2, cex.lab=2, xlab(NULL))
barplot(pcaC$rotation[,3], main="PC 3",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(11,7,11,1)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaC$rotation[,1], main="PC 1",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc1,cex.sub=2, cex.lab=2, xlab(NULL))
barplot(pcaC$rotation[,2], main="PC 2",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc2,cex.sub=2, cex.lab=2, xlab(NULL))
barplot(pcaC$rotation[,3], main="PC 3",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(7,7,5,1)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaC$rotation[,1], main="PC 1",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc1,cex.sub=2, cex.lab=2, xlab(NULL))
barplot(pcaC$rotation[,2], main="PC 2",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc2,cex.sub=2, cex.lab=2, xlab(NULL))
barplot(pcaC$rotation[,3], main="PC 3",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(7,7,15,1)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaC$rotation[,1], main="PC 1",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc1,cex.sub=2, cex.lab=2, xlab(NULL))
barplot(pcaC$rotation[,2], main="PC 2",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc2,cex.sub=2, cex.lab=2, xlab(NULL))
barplot(pcaC$rotation[,3], main="PC 3",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mfrow = c(1, 1))
barplot(pcaC$rotation[,3], main="PC 3",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(17,17,15,11)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaC$rotation[,3], main="PC 3",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(9,9,9,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaC$rotation[,3], main="PC 3",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,11,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaC$rotation[,3], main="PC 3",cex.main=4, cex.axis=3, ylim = c(-0.05, 0.05), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,11,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaC$rotation[,3], main="PC 3",cex.main=4, cex.axis=3, ylim = c(-0.1, 0.1), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaC$rotation[,3], main="PC 3",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaC$rotation[,1], main="PC 1",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=c.pc1,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaC$rotation[,2], main="PC 2",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=c.pc2,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaC$rotation[,2], main="PC 2, Cappricia",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=c.pc2,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaC$rotation[,1], main="PC 1, Cappricia",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=c.pc1,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaC$rotation[,3], main="PC 3, Cappricia",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=c.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaP$rotation[,1], main="PC 1, Provine",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=c.pc,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaP$rotation[,1], main="PC 1, Provine",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=c.pc,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaP$rotation[,1], main="PC 1, Provine",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=cP.pc,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaP$rotation[,1], main="PC 1, Provine",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=cP.pc1,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaP$rotation[,2], main="PC 2, Provine",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=cP.pc2,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaP$rotation[,3], main="PC 3, Provine",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=cP.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaB$rotation[,1], main="PC 1, Brioso",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=cP.pc1,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaB$rotation[,2], main="PC 2, Brioso",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=cP.pc2,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaB$rotation[,3], main="PC 3, Brioso",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=cP.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaB$rotation[,3], main="PC 3, Brioso",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=cB.pc3,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaB$rotation[,2], main="PC 2, Brioso",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=cB.pc2,cex.sub=2, cex.lab=2, cex.names=2)
par(mar=c(14,9,13,9)) # Set margins
par(mfrow = c(1, 1))
barplot(pcaB$rotation[,1], main="PC 1, Brioso",cex.main=4, cex.axis=3, ylim = c(-0.2, 0.2), las=2, col=cB.pc1,cex.sub=2, cex.lab=2, cex.names=2)
